<%
  # Get the Devise model's name to render routes accordingly
  # (e.g., user_federate_logout_path vs. admin_federate_logout_path).
  # This is required to access the resource name on any non-Devise
  # view.
  @resource_name  ||= Devise.mappings.keys[0].to_s
%>

<% if display_logout? @resource_name %>
  <script>
  function janrainCaptureWidgetOnLoad() {
    janrain.settings.capture.flowName = 'signIn';
    janrain.settings.capture.responseType = 'code';
    janrain.capture.ui.start();

    janrain.events.onCaptureSessionEnded.addHandler(function() {
      window.location = '<%= federate_logout_path(@resource_name) %>';
    });
  };
  </script>
  <style>
    #janrainCaptureWidget { display: none; }
  </style>
  <script src="//cdn.oreillystatic.com/members/js/widgets/login-widget.min.js" id="janrainCaptureScript"></script>
  <a href="#" class="signOutLink capture_end_session">Sign Out</a>
<% end %>
